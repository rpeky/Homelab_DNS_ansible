# playbooks/templates/adguardhome.service.j2
[Unit]
Description=AdGuard Home DNS service
After=network-online.target
Wants=network-online.target

[Service]
User={{ adguard_user_resolved }}
Group={{ adguard_group_resolved }}
WorkingDirectory={{ adguard_workdir }}
ExecStart={{ adguard_bin }} -c {{ adguard_conf_resolved }}/AdGuardHome.yaml -w {{ adguard_workdir }}
Restart=on-failure

AmbientCapabilities=CAP_NET_BIND_SERVICE
CapabilityBoundingSet=CAP_NET_BIND_SERVICE
NoNewPrivileges=true
PrivateTmp=true

ProtectSystem=full
ProtectHome=true
ReadWritePaths={{ adguard_conf_resolved }} {{ adguard_workdir }}

LimitNOFILE=16384

[Install]
WantedBy=multi-user.target

